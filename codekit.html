<!DOCTYPE html>
<html>
<head>
  <title>CodeKit</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #fdeef4;
      color: #B76E79;
      font-size: 20px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header, nav, footer {
      background-color: #e75480;
      text-align: center;
      color: #fff;
    }
    header { padding: 30px; }
    nav { padding: 10px; }
    nav a { color: #fff; text-decoration: none; margin: 0 15px; font-size: 1.2em; }
    nav a:hover { color: #ffe6ed; }
    main { flex: 1; display: flex; justify-content: center; align-items: center; }
    .content { display: flex; flex-direction: column; gap: 20px; align-items: center; }
    button {
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 5px;
      border: 2px solid #e75480;
      background-color: #e75480;
      color: #fff;
      cursor: pointer;
    }
    button:hover { background-color: #B76E79; }
  </style>
</head>
<body>
<header><h1>The Coding Atelier</h1></header>
<nav>
  <a href="index.html">Home</a>
  <a href="AboutMe.html">About</a>
  <a href="Faaezah.html">Founder</a>
  <a href="gallery.html">Gallery</a>
  <a href="donate.html">Donate</a>
  <a href="pin.html">Online Codekit</a>
  <a href="resources.html">Resources</a>
  <a href="metrics.html">Impact</a>
  <a href="Contact.html">Contact</a>
</nav>
<main>
  <div class="content">
    <!-- Signed in email -->
    <h2 id="userInfo">Loading user...</h2>

    <!-- Progress text underneath -->
    <p id="progressDisplay">Loading progress...</p>

    <!-- Buttons stacked underneath -->
    <div style="margin-top:20px; display:flex; flex-direction:column; gap:10px; align-items:center;">
      <button id="showProgress" style="display:none;">Click to See Progress</button>
    </div>
    <button id="goActivities">Go to Activities</button>

  </div>
</main>

<footer><p>&copy; 2025 The Coding Atelier</p></footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB6bWIy-y_N6k7F12BZQfDxni85qrIe-Lw",
    authDomain: "the-coding-atelier.firebaseapp.com",
    projectId: "the-coding-atelier",
    storageBucket: "the-coding-atelier.firebasestorage.app",
    messagingSenderId: "469308886574",
    appId: "1:469308886574:web:f70cc92a1cdc63916299bf",
    measurementId: "G-2974BEEE3T"
  };


  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  let cachedProgress = null;

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      document.getElementById("userInfo").textContent = "Signed in as " + user.email;

      const snap = await getDoc(doc(db, "progress", user.uid));
      cachedProgress = snap.exists() ? snap.data().step : 0;

      document.getElementById("showProgress").style.display = "inline-block";
    } else {
      window.location.href = "signin.html";
    }
  });

  document.getElementById("goActivities").addEventListener("click", () => {
    window.location.href = "activities.html";
  });

  document.getElementById("showProgress").addEventListener("click", () => {
    document.getElementById("progressDisplay").textContent = "Your progress: Step " + cachedProgress;
  });
</script>

</body>
</html>
